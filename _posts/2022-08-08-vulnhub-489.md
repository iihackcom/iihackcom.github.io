---
layer: article
title: Vulnhub 489 HA-NATRAJ
tags: pentest vulnhub writeup
---

考点：文件包含、权限继承

靶机链接：https://www.vulnhub.com/entry/ha-natraj,489/

## 环境配置

| 名称       | IP        |
| ---------- | --------- |
| Kali Linux | 10.0.2.15 |
| natraj     | 10.0.2.6  |

## 初步打点

### 端口扫描

```bash
$ export rip=10.0.2.6
$ nmap -v -A -p- $rip
Starting Nmap 7.92 ( https://nmap.org ) at 2022-08-14 00:39 EDT
NSE: Loaded 155 scripts for scanning.
NSE: Script Pre-scanning.
Initiating NSE at 00:39
Completed NSE at 00:39, 0.00s elapsed
Initiating NSE at 00:39
Completed NSE at 00:39, 0.00s elapsed
Initiating NSE at 00:39
Completed NSE at 00:39, 0.00s elapsed
Initiating Ping Scan at 00:39
Scanning 10.0.2.6 [2 ports]
Completed Ping Scan at 00:39, 0.00s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 00:39
Completed Parallel DNS resolution of 1 host. at 00:39, 0.01s elapsed
Initiating Connect Scan at 00:39
Scanning localhost (10.0.2.6) [65535 ports]
Discovered open port 80/tcp on 10.0.2.6
Discovered open port 22/tcp on 10.0.2.6
Completed Connect Scan at 00:39, 6.22s elapsed (65535 total ports)
Initiating Service scan at 00:39
Scanning 2 services on localhost (10.0.2.6)
Completed Service scan at 00:40, 6.02s elapsed (2 services on 1 host)
NSE: Script scanning 10.0.2.6.
Initiating NSE at 00:40
Completed NSE at 00:40, 0.24s elapsed
Initiating NSE at 00:40
Completed NSE at 00:40, 0.01s elapsed
Initiating NSE at 00:40
Completed NSE at 00:40, 0.00s elapsed
Nmap scan report for localhost (10.0.2.6)
Host is up (0.0028s latency).
Not shown: 65533 closed tcp ports (conn-refused)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 d9:9f:da:f4:2e:67:01:92:d5:da:7f:70:d0:06:b3:92 (RSA)
|   256 bc:ea:f1:3b:fa:7c:05:0c:92:95:92:e9:e7:d2:07:71 (ECDSA)
|_  256 f0:24:5b:7a:3b:d6:b7:94:c4:4b:fe:57:21:f8:00:61 (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-title: HA:Natraj
| http-methods: 
|_  Supported Methods: GET POST OPTIONS HEAD
|_http-server-header: Apache/2.4.29 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

```

看来漏洞大概率只能出在web应用上了

### WEB测试

查看源代码，全静态，看看有没有二级目录

#### dirb

```bash
$ dirb http://10.0.2.6/
-----------------
URL_BASE: http://10.0.2.6/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt
-----------------
GENERATED WORDS: 4612                                                          

---- Scanning URL: http://10.0.2.6/ ----
==> DIRECTORY: http://10.0.2.6/console/                                                                            
==> DIRECTORY: http://10.0.2.6/images/                                                                             
+ http://10.0.2.6/index.html (CODE:200|SIZE:14497)                                                                 
+ http://10.0.2.6/server-status (CODE:403|SIZE:273)  
```

#### dirsearch

```bash
$ dirsearch -u http://10.0.2.6/
Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 30 | Wordlist size: 10927
Target: http://10.0.2.6/
[04:01:31] Starting: 
[04:01:32] 403 -  273B  - /.htaccess.bak1                                  
[04:01:32] 403 -  273B  - /.htaccess.orig
[04:01:32] 403 -  273B  - /.htaccess_orig                                  
[04:01:32] 403 -  273B  - /.htaccess_sc
[04:01:32] 403 -  273B  - /.htaccessOLD2
[04:01:32] 403 -  273B  - /.htaccessBAK
[04:01:32] 403 -  273B  - /.htaccess.sample
[04:01:32] 403 -  273B  - /.htaccess_extra
[04:01:32] 403 -  273B  - /.htaccessOLD
[04:01:32] 403 -  273B  - /.htm
[04:01:32] 403 -  273B  - /.ht_wsr.txt                                     
[04:01:32] 403 -  273B  - /.html
[04:01:32] 403 -  273B  - /.htaccess.save
[04:01:32] 403 -  273B  - /.htpasswd_test
[04:01:32] 403 -  273B  - /.httr-oauth                                     
[04:01:32] 403 -  273B  - /.htpasswds                                      
[04:01:33] 403 -  273B  - /.php                                            
[04:01:51] 301 -  306B  - /console  ->  http://10.0.2.6/console/            
[04:01:51] 200 -  936B  - /console/
[04:01:56] 200 -    5KB - /images/                                          
[04:01:56] 301 -  305B  - /images  ->  http://10.0.2.6/images/              
[04:01:56] 200 -   14KB - /index.html                                       
[04:02:12] 403 -  273B  - /server-status/                                   
[04:02:13] 403 -  273B  - /server-status                                    
                                                                             
Task Completed 
```



### 漏洞发现

## 获得权限

### 靶机测试

## 提权
